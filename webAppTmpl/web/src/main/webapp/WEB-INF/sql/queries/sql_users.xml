<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
        "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.nielsen.media.mediaView.tam.prompting.scheduleMapper">
	<resultMap id="UserWithRoleMap" type="User">
		<id property="userId" column="USER_ID" />
		<result property="userName" column="USER_NAME" />
		<result property="userMail" column="USER_MAIL" />
		<result property="password" column="PASSWORD" />
		<result property="userFirstName" column="USER_FIRST_NAME" />
		<result property="userLastName" column="USER_LAST_NAME" />
		<collection property="userRoles" column="rm_id" ofType="Role" 
			javaType="ArrayList" resultMap="RoleMap" />
	</resultMap>

	<resultMap id="RoleMap" type="Role">
		<id property="roleId" column="ROLE_ID" />
		<result property="roleName" column="ROLE_NAME" />
		<result property="roleDescription" column="ROLE_DESC" />
	</resultMap>


	<select id="getAllUsers" resultType="hashmap">
		SELECT
		*
		FROM
		USER
	</select>
	<select id="getUserByAnyIdentity" resultType="hashmap">
		SELECT
		*
		FROM
		USER
		WHERE
		( USER_ID = #{userIdentity} OR
		USER_NAME = #{userIdentity} OR
		USER_MAIL = #{userIdentity} ) AND
		PASSWORD = #{password}
	</select>
</mapper>